/* rimu 3.4.2 (https://github.com/srackham/rimu.git) */
var Rimu=function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:false};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.loaded=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.p="";return __webpack_require__(0)}([function(module,exports,__webpack_require__){var render_1=__webpack_require__(1);var options=__webpack_require__(2);var quotes=__webpack_require__(3);function render(source,opts){if(opts===void 0){opts={}}options.update(opts);return render_1.renderSource(source)}exports.render=render;quotes.initialize()},function(module,exports,__webpack_require__){var io=__webpack_require__(4);var lineBlocks=__webpack_require__(5);var delimitedBlocks=__webpack_require__(6);var lists=__webpack_require__(8);function renderSource(source){var reader=new io.Reader(source);var writer=new io.Writer;while(!reader.eof()){reader.skipBlankLines();if(reader.eof())break;if(lineBlocks.render(reader,writer))continue;if(lists.render(reader,writer))continue;if(delimitedBlocks.render(reader,writer))continue;throw"no matching delimited block found"}return writer.toString()}exports.renderSource=renderSource},function(module,exports,__webpack_require__){var utils=__webpack_require__(7);exports.safeMode;exports.htmlReplacement;function update(options){exports.safeMode="safeMode"in options?options.safeMode:0;exports.htmlReplacement="htmlReplacement"in options?options.htmlReplacement:"<mark>replaced HTML</mark>"}exports.update=update;function safeModeFilter(html){switch(exports.safeMode){case 0:return html;case 1:return"";case 2:return exports.htmlReplacement;case 3:return utils.replaceSpecialChars(html);default:throw"illegal safeMode value"}}exports.safeModeFilter=safeModeFilter;update({})},function(module,exports,__webpack_require__){var utils=__webpack_require__(7);exports.defs=[{quote:"_",openTag:"<em>",closeTag:"</em>",spans:true},{quote:"**",openTag:"<strong>",closeTag:"</strong>",spans:true},{quote:"*",openTag:"<strong>",closeTag:"</strong>",spans:true},{quote:"`",openTag:"<code>",closeTag:"</code>",spans:false},{quote:"~~",openTag:"<del>",closeTag:"</del>",spans:true}];exports.findRe;var unescapeRe;function initialize(){var s=[];for(var i in exports.defs){s.push(utils.escapeRegExp(exports.defs[i].quote))}exports.findRe=RegExp("\\\\?("+s.join("|")+")([^\\s\\\\]|\\S[\\s\\S]*?[^\\s\\\\])\\1","g");unescapeRe=RegExp("\\\\("+s.join("|")+")","g")}exports.initialize=initialize;function getDefinition(quote){for(var i in exports.defs){if(exports.defs[i].quote===quote)return exports.defs[i]}return null}exports.getDefinition=getDefinition;function unescape(s){return s.replace(unescapeRe,"$1")}exports.unescape=unescape;function setDefinition(def){for(var i in exports.defs){if(exports.defs[i].quote===def.quote){exports.defs[i].openTag=def.openTag;exports.defs[i].closeTag=def.closeTag;exports.defs[i].spans=def.spans;return}}if(def.quote.length===2){exports.defs.unshift(def)}else{exports.defs.push(def)}initialize()}exports.setDefinition=setDefinition},function(module,exports,__webpack_require__){var Reader=function(){function Reader(text){this.lines=text.split(/\r\n|\r|\n/g);this.pos=0}Reader.prototype.cursor=function(value){if(value===void 0){value=null}if(this.eof())return null;if(value!==null){this.lines[this.pos]=value}return this.lines[this.pos]};Reader.prototype.eof=function(){return this.pos>=this.lines.length};Reader.prototype.next=function(){if(this.eof())return null;this.pos++;if(this.eof())return null;return this.lines[this.pos]};Reader.prototype.readTo=function(find){var result=[];var match;while(!this.eof()){match=this.cursor().match(find);if(match){if(match.length>1){result.push(match[1])}this.next();break}result.push(this.cursor());this.next()}if(match||find.toString()==="/^$/"&&this.eof()){return result}else{return null}};Reader.prototype.skipBlankLines=function(){while(this.cursor()===""){this.next()}};return Reader}();exports.Reader=Reader;var Writer=function(){function Writer(){this.buffer=[]}Writer.prototype.write=function(s){this.buffer.push(s)};Writer.prototype.toString=function(){return this.buffer.join("")};return Writer}();exports.Writer=Writer},function(module,exports,__webpack_require__){var utils=__webpack_require__(7);var options=__webpack_require__(2);var delimitedBlocks=__webpack_require__(6);var quotes=__webpack_require__(3);var replacements=__webpack_require__(9);var macros=__webpack_require__(10);var defs=[{match:/^\\?\|([\w\-]+)\|\s*=\s*'(.*)'$/,replacement:"",expansionOptions:{},filter:function(match){if(options.safeMode!==0){return""}delimitedBlocks.setDefinition(match[1],match[2]);return""}},{match:/^(\S{1,2})\s*=\s*'([^\|]*)(\|{1,2})(.*)'$/,replacement:"",expansionOptions:{macros:true},filter:function(match){if(options.safeMode!==0){return""}quotes.setDefinition({quote:match[1],openTag:utils.replaceInline(match[2],this.expansionOptions),closeTag:utils.replaceInline(match[4],this.expansionOptions),spans:match[3]==="|"});return""}},{match:/^\\?\/(.+)\/([igm]*)\s*=\s*'(.*)'$/,replacement:"",expansionOptions:{macros:true},filter:function(match){if(options.safeMode!==0){return""}var pattern=match[1];var flags=match[2];var replacement=match[3];replacement=utils.replaceInline(replacement,this.expansionOptions);replacements.setDefinition(pattern,flags,replacement);return""}},{match:macros.MACRO_DEF,replacement:"",expansionOptions:{macros:true},filter:function(match){if(options.safeMode!==0){return""}var name=match[1];var value=match[2];value=utils.replaceInline(value,this.expansionOptions);macros.setValue(name,value);return""}},{match:macros.MACRO_LINE,replacement:"",expansionOptions:{},verify:function(match){return!macros.MACRO_DEF_OPEN.test(match[0])},filter:function(match,reader){var value=macros.render(match[0]);var spliceArgs=[reader.pos+1,0].concat(value.split("\n"));Array.prototype.splice.apply(reader.lines,spliceArgs);return""}},{match:/^\\?((?:#|=){1,6})\s+(.+?)(?:\s+(?:#|=){1,6})?$/,replacement:"<h$1>$2</h$1>",expansionOptions:{macros:true,spans:true},filter:function(match){match[1]=match[1].length.toString();return utils.replaceMatch(match,this.replacement,this.expansionOptions)}},{match:/^\\?\/{2}(.*)$/,replacement:"",expansionOptions:{}},{match:/^\\?<image:([^\s\|]+)\|([\s\S]+?)>$/,replacement:'<img src="$1" alt="$2">',expansionOptions:{macros:true,specials:true}},{match:/^\\?<image:([^\s\|]+?)>$/,replacement:'<img src="$1" alt="$1">',expansionOptions:{macros:true,specials:true}},{match:/^\\?<<#([a-zA-Z][\w\-]*)>>$/,replacement:'<div id="$1"></div>',expansionOptions:{macros:true,specials:true}},{name:"attributes",match:/^\\?\.[a-zA-Z#\[+-].*$/,replacement:"",expansionOptions:{macros:true},verify:function(match){var text=match[0];text=utils.replaceInline(text,this.expansionOptions);match=/^\\?\.([a-zA-Z][\w\ -]*)?(#[a-zA-Z][\w\-]*\s*)?(?:\s*)?(\[.+\])?(?:\s*)?([+-][ \w+-]+)?$/.exec(text);if(!match){return false}if(match[1]){exports.htmlClasses+=" "+utils.trim(match[1]);exports.htmlClasses=utils.trim(exports.htmlClasses)}if(match[2]){exports.htmlAttributes+=' id="'+utils.trim(match[2]).slice(1)+'"'}if(match[3]&&options.safeMode===0){exports.htmlAttributes+=" "+utils.trim(match[3].slice(1,match[3].length-1))}exports.htmlAttributes=utils.trim(exports.htmlAttributes);delimitedBlocks.setBlockOptions(exports.blockOptions,match[4]);return true},filter:function(match){return""}}];exports.htmlClasses="";exports.htmlAttributes="";exports.blockOptions={};function render(reader,writer){if(reader.eof())throw"premature eof";for(var i in defs){var def=defs[i];var match=def.match.exec(reader.cursor());if(match){if(match[0][0]==="\\"){reader.cursor(reader.cursor().slice(1));continue}if(def.verify&&!def.verify(match)){continue}var text;if(!def.filter){text=utils.replaceMatch(match,def.replacement,def.expansionOptions)}else{text=def.filter(match,reader)}text=utils.injectHtmlAttributes(text);writer.write(text);reader.next();if(text&&!reader.eof()){writer.write("\n")}return true}}return false}exports.render=render;function getDefinition(name){for(var i in defs){if(defs[i].name===name){return defs[i]}}return null}exports.getDefinition=getDefinition},function(module,exports,__webpack_require__){var render_1=__webpack_require__(1);var utils=__webpack_require__(7);var options=__webpack_require__(2);var macros=__webpack_require__(10);var lineBlocks=__webpack_require__(5);var defs=[{openMatch:macros.MACRO_DEF_OPEN,closeMatch:macros.MACRO_DEF_CLOSE,openTag:"",closeTag:"",expansionOptions:{macros:true},filter:function(text,match,expansionOptions){var name=match[0].match(/^\{([\w\-]+)\}/)[1];text=text.replace(/' *\\\n/g,"'\n");text=text.replace(/(' *[\\]+)\\\n/g,"$1\n");text=utils.replaceInline(text,expansionOptions);macros.setValue(name,text);return""}},{name:"comment",openMatch:/^\\?\/\*+$/,closeMatch:/^\*+\/$/,openTag:"",closeTag:"",expansionOptions:{skip:true,specials:true}},{name:"division",openMatch:/^\\?\.{2,}$/,openTag:"<div>",closeTag:"</div>",expansionOptions:{container:true,specials:true}},{name:"quote",openMatch:/^\\?"{2,}$/,openTag:"<blockquote>",closeTag:"</blockquote>",expansionOptions:{container:true,specials:true}},{name:"code",openMatch:/^\\?(?:\-{2,}|\x60{2,})$/,openTag:"<pre><code>",closeTag:"</code></pre>",expansionOptions:{macros:false,specials:true}},{name:"html",openMatch:/^(<!.*|(?:<\/?(?:html|head|body|iframe|script|style|address|article|aside|audio|blockquote|canvas|dd|div|dl|fieldset|figcaption|figure|figcaption|footer|form|h1|h2|h3|h4|h5|h6|header|hgroup|hr|img|math|nav|noscript|ol|output|p|pre|section|table|tfoot|td|th|tr|ul|video)(?:[ >].*)?))$/i,closeMatch:/^$/,openTag:"",closeTag:"",expansionOptions:{macros:true},filter:function(text){return options.safeModeFilter(text)}},{name:"indented",openMatch:/^\\?(\s+.*)$/,closeMatch:/^$/,openTag:"<pre><code>",closeTag:"</code></pre>",expansionOptions:{macros:false,specials:true},filter:function(text){var first_indent=text.search(/\S/);var buffer=text.split("\n");for(var i in buffer){var indent=buffer[i].search(/\S/);if(indent>first_indent)indent=first_indent;buffer[i]=buffer[i].slice(indent)}return buffer.join("\n")}},{name:"quote-paragraph",openMatch:/^\\?(>.*)$/,closeMatch:/^$/,openTag:"<blockquote><p>",closeTag:"</p></blockquote>",expansionOptions:{macros:true,spans:true,specials:true},filter:function(text){var buffer=text.split("\n");for(var i in buffer){buffer[i]=buffer[i].replace(/^>/,"");buffer[i]=buffer[i].replace(/^\\>/,">")}return buffer.join("\n")}},{name:"paragraph",openMatch:/^(.*)$/,closeMatch:/^$/,openTag:"<p>",closeTag:"</p>",expansionOptions:{macros:true,spans:true,specials:true}}];function render(reader,writer){if(reader.eof())throw"premature eof";for(var i in defs){var def=defs[i];var match=reader.cursor().match(def.openMatch);if(match){if(match[0][0]==="\\"&&def.name!=="paragraph"){reader.cursor(reader.cursor().slice(1));continue}if(def.verify&&!def.verify(match)){continue}var lines=[];if(match.length>1){lines.push(match[1])}reader.next();var closeMatch;if(def.closeMatch===undefined){closeMatch=RegExp("^"+utils.escapeRegExp(match[0])+"$")}else{closeMatch=def.closeMatch}var content=reader.readTo(closeMatch);if(content!==null){lines=lines.concat(content)}var expansionOptions;expansionOptions={macros:false,spans:false,specials:false,container:false,skip:false};var k;for(k in expansionOptions)expansionOptions[k]=def.expansionOptions[k];for(k in lineBlocks.blockOptions)expansionOptions[k]=lineBlocks.blockOptions[k];if(!expansionOptions.skip){var text=lines.join("\n");if(def.filter){text=def.filter(text,match,expansionOptions)}writer.write(utils.injectHtmlAttributes(def.openTag));if(expansionOptions.container){text=render_1.renderSource(text)}else{text=utils.replaceInline(text,expansionOptions)}writer.write(text);writer.write(def.closeTag);if((def.openTag||text||def.closeTag)&&!reader.eof()){writer.write("\n")}}lineBlocks.blockOptions={};return true}}return false}exports.render=render;function getDefinition(name){for(var i in defs){if(defs[i].name===name){return defs[i]}}return null}exports.getDefinition=getDefinition;function setBlockOptions(blockOptions,optionsString){if(optionsString){var opts=optionsString.trim().split(/\s+/);for(var i in opts){var opt=opts[i];if(options.safeMode!==0&&opt==="-specials"){return}if(/^[+-](macros|spans|specials|container|skip)$/.test(opt)){blockOptions[opt.slice(1)]=opt[0]==="+"}}}}exports.setBlockOptions=setBlockOptions;function setDefinition(name,value){var def=getDefinition(name);var match=utils.trim(value).match(/^(?:(<[a-zA-Z].*>)\|(<[a-zA-Z\/].*>))?(?:\s*)?([+-][ \w+-]+)?$/);if(match){if(match[1]){def.openTag=match[1];def.closeTag=match[2]}setBlockOptions(def.expansionOptions,match[3])}}exports.setDefinition=setDefinition},function(module,exports,__webpack_require__){var macros=__webpack_require__(10);var spans=__webpack_require__(11);var lineBlocks=__webpack_require__(5);function trimLeft(s){return s.replace(/^\s+/g,"")}exports.trimLeft=trimLeft;function trimRight(s){return s.replace(/\s+$/g,"")}exports.trimRight=trimRight;function trim(s){return s.replace(/^\s+|\s+$/g,"")}exports.trim=trim;function escapeRegExp(s){return s.replace(/[\-\/\\\^$*+?.()|\[\]{}]/g,"\\$&")}exports.escapeRegExp=escapeRegExp;function replaceSpecialChars(s){return s.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;")}exports.replaceSpecialChars=replaceSpecialChars;function replaceMatch(match,replacement,expansionOptions){return replacement.replace(/\$\d/g,function(){var i=parseInt(arguments[0][1]);var text=match[i];return replaceInline(text,expansionOptions)})}exports.replaceMatch=replaceMatch;function replaceInline(text,expansionOptions){if(expansionOptions.macros){text=macros.render(text);text=text===null?"":text}if(expansionOptions.spans){return spans.render(text)}else if(expansionOptions.specials){return replaceSpecialChars(text)}else{return text}}exports.replaceInline=replaceInline;function injectHtmlAttributes(tag){if(!tag){return tag}if(lineBlocks.htmlClasses){if(/class="\S.*"/.test(tag)){tag=tag.replace(/class="(\S.*?)"/,'class="'+lineBlocks.htmlClasses+' $1"')}else{lineBlocks.htmlAttributes=trim('class="'+lineBlocks.htmlClasses+'" '+lineBlocks.htmlAttributes)}}if(lineBlocks.htmlAttributes){var match=tag.match(/^<([a-zA-Z]+|h[1-6])(?=[ >])/);if(match){var before=tag.slice(0,match[0].length);var after=tag.slice(match[0].length);tag=before+" "+lineBlocks.htmlAttributes+after}}lineBlocks.htmlClasses="";lineBlocks.htmlAttributes="";return tag}exports.injectHtmlAttributes=injectHtmlAttributes},function(module,exports,__webpack_require__){var utils=__webpack_require__(7);var io=__webpack_require__(4);var delimitedBlocks=__webpack_require__(6);var defs=[{match:/^\\?\s*(-|\*{1,4})\s+(.*)$/,listOpenTag:"<ul>",listCloseTag:"</ul>",itemOpenTag:"<li>",itemCloseTag:"</li>"},{match:/^\\?\s*(?:\d*)(\.{1,4})\s+(.*)$/,listOpenTag:"<ol>",listCloseTag:"</ol>",itemOpenTag:"<li>",itemCloseTag:"</li>"},{match:/^\\?\s*(.*[^:])(:{2,4})(|\s+.*)$/,listOpenTag:"<dl>",listCloseTag:"</dl>",itemOpenTag:"<dd>",itemCloseTag:"</dd>",termOpenTag:"<dt>",termCloseTag:"</dt>"}];var ids;function render(reader,writer){if(reader.eof())throw"premature eof";var startItem;if(!(startItem=matchItem(reader))){return false}ids=[];renderList(startItem,reader,writer);return true}exports.render=render;function renderList(startItem,reader,writer){ids.push(startItem.id);writer.write(utils.injectHtmlAttributes(startItem.def.listOpenTag));var nextItem;while(true){nextItem=renderListItem(startItem,reader,writer);if(!nextItem||nextItem.id!==startItem.id){writer.write(startItem.def.listCloseTag);ids.pop();return nextItem}startItem=nextItem}}function renderListItem(startItem,reader,writer){var def=startItem.def;var match=startItem.match;var text;if(match.length===4){writer.write(def.termOpenTag);text=utils.replaceInline(match[1],{macros:true,spans:true});writer.write(text);writer.write(def.termCloseTag)}writer.write(def.itemOpenTag);var lines=new io.Writer;lines.write(match[match.length-1]);lines.write("\n");reader.next();var nextItem;nextItem=readToNext(reader,lines);text=lines.toString();text=utils.replaceInline(text,{macros:true,spans:true});writer.write(text);while(true){if(!nextItem){writer.write(def.itemCloseTag);return null}else if(nextItem.isListItem){if(ids.indexOf(nextItem.id)!==-1){writer.write(def.itemCloseTag);return nextItem}else{nextItem=renderList(nextItem,reader,writer);writer.write(def.itemCloseTag);return nextItem}}else if(nextItem.isDelimited||nextItem.isIndented){var savedIds=ids;ids=[];delimitedBlocks.render(reader,writer);ids=savedIds;reader.skipBlankLines();if(reader.eof()){writer.write(def.itemCloseTag);return null}else{nextItem=matchItem(reader)}}}}function readToNext(reader,writer){var next;while(true){if(reader.eof())return null;if(reader.cursor()===""){reader.skipBlankLines();if(reader.eof())return null;return matchItem(reader,{indented:true})}next=matchItem(reader,{delimited:true});if(next){return next}writer.write(reader.cursor());writer.write("\n");reader.next()}}function matchItem(reader,options){if(options===void 0){options={}}var line=reader.cursor();var item={};for(var i in defs){var match=defs[i].match.exec(line);if(match){if(match[0][0]==="\\"){reader.cursor(reader.cursor().slice(1));return null}item.match=match;item.def=defs[i];item.id=match[match.length-2];item.isListItem=true;return item}}var def;if(options.delimited){for(var name in{quote:0,code:0,division:0}){def=delimitedBlocks.getDefinition(name);if(def.openMatch.test(line)){item.isDelimited=true;return item}}}if(options.indented){def=delimitedBlocks.getDefinition("indented");if(def.openMatch.test(line)){item.isIndented=true;return item}}return null}},function(module,exports,__webpack_require__){var options=__webpack_require__(2);exports.defs=[{match:/\\?(&[\w#][\w]+;)/g,replacement:"",filter:function(match){return match[1]}},{match:/[\\ ]\\(\n|$)/g,replacement:"<br>$1"},{match:/\\?<<#([a-zA-Z][\w\-]*)>>/g,replacement:'<span id="$1"></span>'},{match:/\\?<image:([^\s\|]+)\|([\s\S]*?)>/g,replacement:'<img src="$1" alt="$2">'},{match:/\\?<image:([^\s\|]+?)>/g,replacement:'<img src="$1" alt="$1">'},{match:/\\?!\[([\s\S]*?)\]\s*\((\S+?)\)/g,replacement:'<img src="$2" alt="$1">'},{match:/\\?<(\S+@[\w\.\-]+)\|([\s\S]+?)>/g,replacement:'<a href="mailto:$1">$2</a>'},{match:/\\?<(\S+@[\w\.\-]+)>/g,replacement:'<a href="mailto:$1">$1</a>'},{match:/\\?(<[!\/]?[a-zA-Z\-]+(:?\s+[^<>&]+)?>)/g,replacement:"",filter:function(match){return options.safeModeFilter(match[1])}},{match:/\\?<(\S+?)\|([\s\S]*?)>/g,replacement:'<a href="$1">$2</a>'},{match:/\\?<(\S+?)>/g,replacement:'<a href="$1">$1</a>'},{match:/\\?\[([\s\S]*?)\]\s*\((\S+?)\)/g,replacement:'<a href="$2">$1</a>'},{match:/(^|[^<])\b((?:http|https):\/\/[^\s"']*[^\s"',.;?)])/g,replacement:'$1<a href="$2">$2</a>'}];function setDefinition(regexp,flags,replacement){if(!/g/.test(flags)){flags+="g"}for(var i in exports.defs){if(exports.defs[i].match.source===regexp){exports.defs[i].match=new RegExp(regexp,flags);exports.defs[i].replacement=replacement;return}}exports.defs.unshift({match:new RegExp(regexp,flags),replacement:replacement})}exports.setDefinition=setDefinition},function(module,exports,__webpack_require__){var MATCH_MACRO=/\{([\w\-]+)([!=|?](?:|[\s\S]*?[^\\]))?\}/;var MATCH_MACROS=RegExp("\\\\?"+MATCH_MACRO.source,"g");exports.MACRO_LINE=RegExp("^"+MATCH_MACRO.source+".*$");exports.MACRO_DEF_OPEN=/^\\?\{[\w\-]+\}\s*=\s*'(.*)$/;exports.MACRO_DEF_CLOSE=/^(.*)'$/;exports.MACRO_DEF=/^\\?\{([\w\-]+)\}\s*=\s*'(.*)'$/;exports.defs=[];function getValue(name){for(var i in exports.defs){if(exports.defs[i].name===name){return exports.defs[i].value}}return null}exports.getValue=getValue;function setValue(name,value){for(var i in exports.defs){if(exports.defs[i].name===name){exports.defs[i].value=value;return}}exports.defs.push({name:name,value:value})}exports.setValue=setValue;function render(text){text=text.replace(MATCH_MACROS,function(match){var args=[];for(var _i=1;_i<arguments.length;_i++){args[_i-1]=arguments[_i]}if(match[0]==="\\"){return match.slice(1)}var name=args[0];var params=args[1]||"";var value=getValue(name);params=params.replace(/\\\}/g,"}");switch(params[0]){case"?":return value===null?params.slice(1):value;case"|":var paramsList=params.slice(1).split("|");value=(value||"").replace(/\\?\$\d+/g,function(match){if(match[0]==="\\"){return match.slice(1)}var param=paramsList[parseInt(match.slice(1))-1];return param===undefined?"":param});return value;case"!":case"=":var pattern=params.slice(1);var skip=!RegExp("^"+pattern+"$").test(value||"");if(params[0]==="!"){skip=!skip}return skip?"\x00":"";default:return value||""}});if(text.indexOf("\x00")!==-1){var lines=text.split("\n");for(var i=lines.length-1;i>=0;--i){if(lines[i].indexOf("\x00")!==-1){lines.splice(i,1)}}text=lines.join("\n")}return text}exports.render=render},function(module,exports,__webpack_require__){var utils=__webpack_require__(7);var quotes=__webpack_require__(3);var replacements=__webpack_require__(9);function render(source){var fragments=[{text:source,done:false}];fragQuotes(fragments);fragReplacements(fragments);fragSpecials(fragments);return defrag(fragments)}exports.render=render;function defrag(fragments){var result=[];for(var i in fragments){result.push(fragments[i].text)}return result.join("")}function fragQuotes(fragments){var findRe=quotes.findRe;var fragmentIndex=0;var fragment=fragments[fragmentIndex];var nextFragment;var match;findRe.lastIndex=0;while(true){if(fragment.done){nextFragment=true}else{match=findRe.exec(fragment.text);nextFragment=!match}if(nextFragment){fragmentIndex++;if(fragmentIndex>=fragments.length){break}fragment=fragments[fragmentIndex];if(match){findRe.lastIndex=0}continue}if(match[0][0]==="\\"){findRe.lastIndex=match.index+match[1].length+1;continue}var def=quotes.getDefinition(match[1]);if(def.verify&&!def.verify(match,findRe)){findRe.lastIndex=match.index+match[1].length+1;continue}var before=match.input.slice(0,match.index);var quoted=match[2];var after=match.input.slice(findRe.lastIndex);fragments.splice(fragmentIndex,1,{text:before,done:false},{text:def.openTag,done:true},{text:quoted,done:false},{text:def.closeTag,done:true},{text:after,done:false});fragmentIndex+=2;fragment=fragments[fragmentIndex];if(!def.spans){fragment.text=quotes.unescape(fragment.text);fragment.text=utils.replaceSpecialChars(fragment.text);fragment.done=true;fragmentIndex+=2;fragment=fragments[fragmentIndex]}findRe.lastIndex=0}for(var i in fragments){fragment=fragments[i];if(!fragment.done){fragment.text=quotes.unescape(fragment.text)}}}function fragReplacements(fragments){for(var i in replacements.defs){fragReplacement(fragments,replacements.defs[i])}}function fragReplacement(fragments,def){var findRe=def.match;var fragmentIndex=0;var fragment=fragments[fragmentIndex];var nextFragment;var match;findRe.lastIndex=0;while(true){if(fragment.done){nextFragment=true}else{match=findRe.exec(fragment.text);nextFragment=!match}if(nextFragment){fragmentIndex++;if(fragmentIndex>=fragments.length){break}fragment=fragments[fragmentIndex];if(match){findRe.lastIndex=0}continue}var before=match.input.slice(0,match.index);var after=match.input.slice(findRe.lastIndex);fragments.splice(fragmentIndex,1,{text:before,done:false},{text:"",done:true},{text:after,done:false});fragmentIndex++;fragment=fragments[fragmentIndex];if(match[0][0]==="\\"){fragment.text=match.input.slice(match.index+1,findRe.lastIndex);fragment.text=utils.replaceSpecialChars(fragment.text)}else{if(!def.filter){fragment.text=utils.replaceMatch(match,def.replacement,{specials:true})}else{fragment.text=def.filter(match)}}fragmentIndex++;fragment=fragments[fragmentIndex];findRe.lastIndex=0}}function fragSpecials(fragments){var fragment;for(var i in fragments){fragment=fragments[i];if(!fragment.done){fragment.text=utils.replaceSpecialChars(fragment.text)}}}}]);